<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Government Primary School Pethgam Wagoora ‚Äî Admissions</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@300;400;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#f7fbff; --card:#ffffff; --muted:#475569; --brand:#0f62d0;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      font-family: "Nunito", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      margin:0;
      background:linear-gradient(180deg,#f3f9ff,#fbfcff);
      color:#102a43;
      -webkit-font-smoothing:antialiased;
    }

    /* header */
    header.site-header{
      background: linear-gradient(90deg,var(--brand),#0b4fb0);
      color:#fff;
      padding:16px;
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:space-between;
    }
    .header-left{display:flex;align-items:center;gap:12px}
    .logo{width:78px;height:78px;border-radius:10px;object-fit:cover;border:3px solid rgba(255,255,255,0.18)}
    .site-title h1{margin:0;font-size:18px;font-weight:800;font-family:"Fredoka One","Nunito",sans-serif}
    .site-title p.sub{margin:4px 0 0;font-size:13px;opacity:0.95}

    .header-right{display:flex;flex-direction:column;align-items:flex-end;gap:4px;font-size:13px}
    @media (max-width:820px){
      header.site-header{flex-direction:column;align-items:center;text-align:center}
      .header-right{align-items:center}
    }

    /* top row */
    .top-row{display:flex;gap:12px;align-items:center;justify-content:space-between;padding:10px 14px;background:linear-gradient(90deg,#eef7ff,#ffffff);border-bottom:1px solid rgba(15,86,208,0.04)}
    .notifications-scroll{flex:1;margin-left:12px;overflow:hidden;border-radius:12px;background:#fff;padding:8px 10px}
    .ticker{white-space:nowrap;display:inline-block;animation:scroll-left 18s linear infinite;font-weight:700}
    @keyframes scroll-left{0%{transform:translateX(100%)}100%{transform:translateX(-100%)}}

    /* menu */
    nav.menu{display:flex;flex-wrap:wrap;gap:8px;align-items:center;padding:12px 14px;background:transparent;justify-content:center}
    nav.menu a{display:inline-block;padding:10px 16px;border-radius:12px;background:linear-gradient(180deg,#5daaff,#1e90ff);color:#fff;text-decoration:none;font-weight:800;box-shadow:0 6px 0 #0c58a3}
    nav.menu a:active{transform:translateY(4px);box-shadow:0 2px 0 #0c58a3}
    nav.menu a:hover{filter:brightness(1.05)}

    /* layout */
    .container{max-width:1100px;margin:18px auto;padding:0 12px;display:grid;grid-template-columns:1fr 340px;gap:18px}
    @media (max-width:960px){.container{grid-template-columns:1fr;padding:12px}}

    .card{background:var(--card);padding:18px;border-radius:12px;box-shadow:0 8px 20px rgba(12,40,90,0.05)}
    .hero{text-align:center;padding:22px}
    .hero h2{color:var(--brand);font-family:"Fredoka One", "Nunito", sans-serif}
    .small{color:var(--muted);font-size:14px}

    .rainbar{height:10px;border-radius:10px;margin-top:10px;display:flex;overflow:hidden}
    .rainbar>div{flex:1}
    .r1{background:#ff8a80} .r2{background:#ffd180} .r3{background:#fff59d}
    .r4{background:#b9f6ca} .r5{background:#80d8ff} .r6{background:#b388ff}

    .btn-3d{display:inline-block;padding:12px 20px;border-radius:14px;background:linear-gradient(180deg,#80d8ff,#2f6fd8);color:#fff;font-weight:900;cursor:pointer;border:none;box-shadow:0 10px 0 rgba(24,88,200,0.12)}
    .btn-ghost{background:#fff;border:2px solid #e6f0ff;padding:8px 12px;border-radius:10px;cursor:pointer;font-weight:700;color:var(--brand)}

    /* right column news */
    .vertical-news{height:320px;overflow:hidden;border-radius:10px;background:linear-gradient(180deg,#fff,#f7fbff);padding:10px}
    .news-list{display:block;animation:scroll-up 18s linear infinite}
    @keyframes scroll-up{0%{transform:translateY(0)}33%{transform:translateY(-33%)}66%{transform:translateY(-66%)}100%{transform:translateY(0)}}

    /* popup - hidden by default */
    #formPopup{
      position: fixed;
      inset:0;
      display:none;           /* ensure hidden on load */
      background: rgba(6,12,30,0.55);
      z-index:99999;
      align-items:center;
      justify-content:center;
      padding:18px;
    }
    .wizard{ width:100%; max-width:980px; border-radius:12px; background:linear-gradient(180deg,#fff,#fbfcff); display:grid; grid-template-columns:1fr 340px; overflow:hidden; box-shadow:0 30px 60px rgba(8,24,64,0.25);}
    @media (max-width:920px){ .wizard{grid-template-columns:1fr} .wizard .right{order:2} }
    .wizard .left{padding:18px 20px 24px}
    .wizard h3{margin:0 0 10px;color:var(--brand);font-size:18px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    label{font-weight:700;font-size:13px;margin-top:8px;display:block}
    input[type="text"],input[type="tel"],input[type="date"],select,textarea{ width:100%; padding:10px;border-radius:8px;border:1px solid #dbe7ff;background:#fff;margin-top:6px;font-size:14px}
    textarea{min-height:80px;resize:vertical}
    .preview{width:100%;height:200px;background:#fff;border-radius:8px;display:flex;align-items:center;justify-content:center;overflow:hidden;border:1px dashed #e6eefb}
    .submitted{padding:14px;background:linear-gradient(180deg,#e9fff0,#d7fbe4);border-radius:10px;color:#087a3a;font-weight:800;text-align:center}
    .muted{color:var(--muted);font-size:13px}
    .steps{display:flex;gap:8px;margin-top:12px}
    .step{flex:1;padding:10px;border-radius:10px;text-align:center;background:linear-gradient(180deg,#fff,#f5f9ff);color:var(--muted);font-weight:800}
    .step.active{background:linear-gradient(90deg,#b9f6ca,#80d8ff);color:#08306b}

    /* small */
    @media (max-width:520px){
      .logo{width:64px;height:64px}
      .container{grid-template-columns:1fr}
      .wizard{ padding:12px }
    }
  </style>
</head>

<body>
  <!-- HEADER -->
  <header class="site-header" role="banner">
    <div class="header-left">
      <img class="logo" src="https://pspathgam.github.io/ps-pethgam-wagoora/assets/images/school-logo.png.png" alt="School Logo">
      <div class="site-title">
        <h1>Government Primary School Pethgam Wagoora</h1>
        <p class="sub">Wagoora Babareshi Road ‚Äî Near Zonal Education Office</p>
      </div>
    </div>

    <div class="header-right" aria-hidden="false">
      <div><strong>UDISE:</strong> 01022202207</div>
      <div><strong>Email:</strong> pspethgam@gmail.com</div>
      <div id="liveClock" class="live-clock" aria-live="polite">--</div>
    </div>
  </header>

  <!-- TOP ROW -->
  <div class="top-row" role="region" aria-label="Announcements">
    <div style="font-weight:800;color:#08306b">Announcements</div>
    <div class="notifications-scroll" aria-hidden="false">
      <div class="ticker" id="notifTicker">üì¢ Admissions Open ‚Ä¢ Winter Vacation: 1 Dec ‚Äî 28 Feb ‚Ä¢ Upload DOB & Aadhaar ‚Ä¢ Children's Day ‚Ä¢ Contact: 9596449881</div>
    </div>
  </div>

  <!-- MENU -->
  <nav class="menu" role="navigation" aria-label="Main menu">
    <a href="index.html">Home</a>
    <a href="about.html">About</a>
    <a href="students.html">Student Profile</a>
    <a href="examinations.html">Examinations</a>
    <a href="staff.html">Staff</a>
    <a href="circulars.html">Circulars & Orders</a>
    <a href="certificates.html">Certificates</a>
    <a href="gallery.html">Gallery</a>
    <a href="contact.html">Contact</a>
    <a href="login.html">Login</a>
  </nav>

  <!-- MAIN -->
  <div class="container" role="main">
    <main>
      <section class="card hero" aria-labelledby="heroTitle">
        <img src="https://pspathgam.github.io/ps-pethgam-wagoora/assets/images/school-logo.png.png" alt="logo" style="width:100px;border-radius:12px;display:block;margin:6px auto">
        <h2 id="heroTitle">Welcome to Government Primary School Pethgam Wagoora</h2>
        <div class="small">Excellence in foundational education ‚Ä¢ Nursery to Grade 5</div>

        <div class="rainbar" aria-hidden="true"><div class="r1"></div><div class="r2"></div><div class="r3"></div><div class="r4"></div><div class="r5"></div><div class="r6"></div></div>

        <div class="admission-card card" style="margin-top:16px">
          <h3 style="margin:0">Online Admission ‚Äî 2025</h3>
          <p class="small">Apply online, upload student photo and download a prefilled A4 admission PDF.</p>
          <div style="margin-top:14px">
            <button class="btn-3d" onclick="openForm()">Apply Now</button>
          </div>
        </div>
      </section>

      <section class="card" style="margin-top:14px">
        <h3>School Mission</h3>
        <p>To provide child-centered, joyful and inclusive education that builds strong foundations in literacy, numeracy and values.</p>
      </section>

      <section class="card" style="margin-top:14px">
        <h3>Quick Links</h3>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px">
          <div class="card small"><strong>Examinations</strong><p class="small">FA1‚ÄìFA6: 5 marks ‚Ä¢ SA: 50 marks</p></div>
          <div class="card small"><strong>Staff Profile</strong><p class="small">View teacher details</p></div>
          <div class="card small"><strong>Circulars</strong><p class="small">Important administrative circulars</p></div>
          <div class="card small"><strong>Certificates</strong><p class="small">Bonafide, Transfer, DOB</p></div>
        </div>
      </section>
    </main>

    <aside class="right-column">
      <div class="card vertical-news" role="complementary">
        <h4 style="margin-top:0">News, Views & Events</h4>
        <div class="news-list" id="newsList" aria-live="polite">
          <div class="news-item"><strong>14 Nov</strong> - Children's Day celebration</div>
          <div class="news-item"><strong>01 Dec</strong> - Winter vacation begins</div>
          <div class="news-item"><strong>05 Jan</strong> - Parent Teacher Meeting</div>
          <div class="news-item"><strong>20 Feb</strong> - Sports Day practice</div>
          <div class="news-item"><strong>28 Feb</strong> - School reopens</div>
          <!-- duplicates for continuous scroll -->
          <div class="news-item"><strong>14 Nov</strong> - Children's Day celebration</div>
          <div class="news-item"><strong>01 Dec</strong> - Winter vacation begins</div>
          <div class="news-item"><strong>05 Jan</strong> - Parent Teacher Meeting</div>
        </div>
      </div>

      <div class="card" style="margin-top:12px">
        <h4 style="margin-top:0">Contact & Location</h4>
        <div class="small">Wagoora Baberashi Road ‚Äî Near Zonal Education Office</div>
        <div style="margin-top:8px"><strong>Email:</strong> pspethgam@gmail.com</div>
        <div><strong>Phone:</strong> 9596449881, 7006261694</div>
      </div>
    </aside>
  </div>

  <footer style="text-align:center;padding:18px;margin-top:18px;background:linear-gradient(180deg,#eef6ff,#e9f4ff)">
    <div style="font-weight:800">Government Primary School Pethgam Wagoora</div>
    <div class="small">UDISE Code: 01022202207 ‚Ä¢ Wagoora ‚Äî 193109 ‚Ä¢ Email: pspethgam@gmail.com</div>
  </footer>

  <!-- POPUP: TWO-PAGE WIZARD -->
  <div id="formPopup" role="dialog" aria-hidden="true">
    <div class="wizard" role="document" aria-modal="true">
      <div class="left" aria-live="polite">
        <h3 id="wizardTitle">Admission Form ‚Äî Page 1 of 2</h3>

        <div id="page1">
          <div style="margin-bottom:8px;font-weight:700">
            <div>GOVERNMENT PRIMARY SCHOOL PETHGAM WAGOORA</div>
            <div style="font-weight:600">Wagoora Babareshi Road ‚Äî Near Zonal Education Office</div>
            <div style="margin-top:6px">Email ID: pspethgam@gmail.com ‚Ä¢ UDISE Code: 01022202207</div>
          </div>

          <hr>

          <label>Student's Name</label>
          <div class="row">
            <div><input id="stu_first" type="text" placeholder="First"></div>
            <div><input id="stu_middle" type="text" placeholder="Middle"></div>
          </div>
          <div style="margin-top:6px"><input id="stu_last" type="text" placeholder="Last"></div>

          <div style="margin-top:10px;font-weight:800">Name As Per Aadhaar</div>
          <div class="row">
            <div><input id="aad_first" type="text" placeholder="First"></div>
            <div><input id="aad_middle" type="text" placeholder="Middle"></div>
          </div>
          <div style="margin-top:6px"><input id="aad_last" type="text" placeholder="Last"></div>

          <div style="margin-top:10px;font-weight:800">Parent Details</div>
          <div class="row">
            <div><input id="father_name" type="text" placeholder="Father's Name"></div>
            <div><input id="mother_name" type="text" placeholder="Mother's Name"></div>
          </div>

          <div class="row" style="margin-top:8px">
            <div><input id="residence" type="text" placeholder="Residence"></div>
            <div><input id="tehsil" type="text" placeholder="Tehsil"></div>
          </div>

          <div class="row" style="margin-top:8px">
            <div><input id="district" type="text" placeholder="District"></div>
            <div><input id="father_contact" type="tel" placeholder="Father Contact"></div>
          </div>

          <div class="row" style="margin-top:8px">
            <div><input id="mother_contact" type="tel" placeholder="Mother Contact"></div>
            <div><input id="aadhaar_no" type="text" placeholder="Aadhaar Number"></div>
          </div>

          <div class="row" style="margin-top:8px">
            <div><input id="dob_fig" type="date" placeholder="Date of Birth"></div>
            <div><input id="dob_words" type="text" placeholder="Date of Birth in words"></div>
          </div>

          <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
            <button class="btn-ghost" type="button" onclick="closeForm()">Close</button>
            <div style="flex:1"></div>
            <button class="btn-3d" type="button" onclick="nextPage(2)">Next ‚Üí</button>
          </div>
        </div>

        <div id="page2" style="display:none; padding-top:6px;">
          <div style="margin-bottom:8px;font-weight:700">
            <div>GOVERNMENT PRIMARY SCHOOL PETHGAM WAGOORA</div>
            <div style="font-weight:600">UDISE Code: 01022202207</div>
          </div>

          <hr>

          <div class="row">
            <div><input id="bank_acc" type="text" placeholder="Bank Account Number"></div>
            <div><input id="bank_name" type="text" placeholder="Bank Name"></div>
          </div>

          <div class="row" style="margin-top:8px">
            <div><input id="bank_branch" type="text" placeholder="Bank Branch"></div>
            <div><input id="ifsc" type="text" placeholder="IFSC"></div>
          </div>

          <div class="row" style="margin-top:8px">
            <div>
              <select id="category"><option>GENERAL</option><option>SC</option><option>ST</option><option>OBC</option></select>
            </div>
            <div><input id="blood_group" type="text" placeholder="Blood Group"></div>
          </div>

          <div style="margin-top:8px"><input id="ration_no" type="text" placeholder="Ration Card Number"></div>
          <div style="margin-top:8px"><input id="ration_type" type="text" placeholder="Ration Card Type"></div>

          <div style="margin-top:8px" class="row">
            <div>
              <select id="class_join">
                <option>Nursery</option><option>KG</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
              </select>
            </div>
            <div><input id="pen_no" type="text" placeholder="PEN (if transferring)"></div>
          </div>

          <div style="margin-top:8px">
            <textarea id="declaration_text">I do hereby declare that the above information provided by me is true to the best of my knowledge and belief. I further declare that I will abide by the rules and regulations laid down by the school and the department from time to time and I will co-operate with the institution for the betterment of my ward. I hereby give my consent to provide the AADHAAR for the demographic authentication of the student.</textarea>
          </div>

          <div style="margin-top:8px">
            <label>Upload Photo (mobile)</label><br>
            <input id="photoUpload" type="file" accept="image/*">
          </div>

          <div style="margin-top:8px;display:flex;gap:8px;align-items:center">
            <div id="photoBox" class="preview"><span class="muted">No photo</span></div>
            <div style="flex:1"></div>
          </div>

          <div style="margin-top:12px;display:flex;gap:8px;">
            <button class="btn-ghost" type="button" onclick="nextPage(1)">‚Üê Back</button>
            <div style="flex:1"></div>
            <button class="btn-3d" type="button" onclick="submitAdmission()">Submit Now</button>
          </div>
        </div>

        <div id="submittedBox" style="display:none;margin-top:14px">
          <div class="submitted">‚úî Form submitted successfully</div>
          <div style="display:flex;gap:8px;justify-content:center;margin-top:10px">
            <button class="btn-3d" type="button" onclick="generatePDF()">Download PDF</button>
            <button class="btn-ghost" type="button" onclick="closeForm()">Close</button>
          </div>
        </div>
      </div>

      <aside class="right">
        <div style="padding:18px">
          <div style="display:flex;align-items:center;gap:12px">
            <div style="width:64px;height:64px;border-radius:8px;overflow:hidden;background:#fff;display:flex;align-items:center;justify-content:center">
              <img id="previewLogo" src="https://pspathgam.github.io/ps-pethgam-wagoora/assets/images/school-logo.png.png" style="width:100%;height:100%;object-fit:cover" alt="">
            </div>
            <div>
              <div style="font-weight:800">Admission Form</div>
              <div class="small muted">Fill required details and upload a recent photo</div>
            </div>
          </div>

          <div style="margin-top:12px">
            <div class="steps">
              <div class="step active" id="step1">1 ‚Ä¢ Student Details</div>
              <div class="step" id="step2">2 ‚Ä¢ Family & Docs</div>
            </div>
          </div>

          <div style="margin-top:12px">
            <div class="small muted">Preview</div>
            <div style="margin-top:8px">
              <div class="preview" id="pdfPreviewArea">
                <div style="text-align:center">
                  <div style="font-weight:800;color:var(--brand)">GPS Pethgam ‚Äî Preview</div>
                  <div class="small muted">Uploaded photo & brief preview here</div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </aside>
    </div>
  </div>

  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
    // Live clock
    function updateClock(){
      const el = document.getElementById('liveClock');
      if(!el) return;
      const d = new Date();
      const days = ['Sunday','Monday','Tuesday','Wednesday',https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@300;400;700;800&display=swap'Thursday','Friday','Saturday'];
      el.textContent = `${days[d.getDay()]} ‚Ä¢ ${d.toLocaleDateString()} ‚Ä¢ ${d.toLocaleTimeString()}`;
    }
    setInterval(updateClock,1000);
    updateClock();

    // ticker pause
    const ticker = document.getElementById('notifTicker');
    if(ticker){
      ticker.addEventListener('mouseenter', ()=> ticker.style.animationPlayState='paused');
      ticker.addEventListener('mouseleave', ()=> ticker.style.animationPlayState='running');
    }

    // form state & handlers
 const formState = { photoDataUrl: null };

    function openForm(){
      const pop = document.getElementById('formPopup');
      if(!pop) return;
      pop.style.display = 'flex';
      pop.setAttribute('aria-hidden','false');
      showPage(1);
      // attach change listener once
      const file = document.getElementById('photoUpload');
      if(file && !file._attached){ file.addEventListener('change', handlePreview); file._attached = true; }
      // ensure submitted box hidden on open
      const sub = document.getElementById('submittedBox'); if(sub) sub.style.display='none';
    }

    function closeForm(){
      const pop = document.getElementById('formPopup');
      if(!pop) return;
      pop.style.display = 'none';
      pop.setAttribute('aria-hidden','true');
// reset pages
      document.getElementById('submittedBox').style.display = 'none';
      document.getElementById('page1').style.display = 'block';
      document.getElementById('page2').style.display = 'none';
      document.getElementById('step1').classList.add('active');
      document.getElementById('step2').classList.remove('active');
    }

    function showPage(n){
      const p1 = document.getElementById('page1'), p2 = document.getElementById('page2');
      if(p1) p1.style.display = (n===1 ? 'block' : 'none');
      if(p2) p2.style.display = (n===2 ? 'block' : 'none');
      const title = document.getElementById('wizardTitle');
      if(title) title.innerText = `Admission Form ‚Äî Page ${n} of 2`;
      const s1 = document.getElementById('step1'), s2 = document.getElementById('step2');
      if(s1) s1.classList.toggle('active', n===1);
      if(s2) s2.classList.toggle('active', n===2);
    }
function nextPage(n){ showPage(n); }

    function handlePreview(e){
      const file = e.target.files && e.target.files[0];
      const box = document.getElementById('photoBox');
      const previewArea = document.getElementById('pdfPreviewArea');
      if(!box) return;
      if(!file){
        box.innerHTML = '<span class="muted">No photo</span>';
        formState.photoDataUrl = null;
        if(previewArea) previewArea.innerHTML = '<div class="small muted">No photo</div>';
        return;
      }
      const reader = new FileReader();
      reader.onload = function(ev){
        formState.photoDataUrl = ev.target.result;
        box.innerHTML = `<img src="${ev.target.result}" style="width:100%;height:100%;object-fit:cover">`;
        if(previewArea) previewArea.innerHTML = `<div style="text-align:center"><img src="${ev.target.result}" style="width:120px;height:140px;object-fit:cover;border-radius:6px;border:1px solid #ddd"></div>`;
      };
      reader.readAsDataURL(file);
    }

    function submitAdmission(){
      // collect minimal required for validation
      const first = (document.getElementById('stu_first')?.value || '').trim();
      const last = (document.getElementById('stu_last')?.value || '').trim();
      const father = (document.getElementById('father_name')?.value || '').trim();
      const dob = (document.getElementById('dob_fig')?.value || '').trim();

      const fullname = (first + ' ' + last).trim();
      if(!fullname || !father){
        alert('Please enter Student name and Father name.');
        return;
    }
// show submitted UI
      document.getElementById('submittedBox').style.display = 'block';
      document.getElementById('page1').style.display = 'none';
      document.getElementById('page2').style.display = 'none';

      const preview = document.getElementById('pdfPreviewArea');
      if(preview) preview.innerHTML = `<div style="text-align:left;padding:12px;font-size:13px"><strong>Student:</strong> ${escapeHtml(fullname)}<br><strong>Father:</strong> ${escapeHtml(father)}<br><strong>DOB:</strong> ${escapeHtml(dob)}<br><em>Click Download PDF to get the filled form.</em></div>`;
    }

    function escapeHtml(s){ return (s+'').replace(/[&<>"']/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c])); }

    async function generatePDF(){
      try{
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF({ unit:'pt', format:'a4' });
        const W = pdf.internal.pageSize.getWidth();
        const H = pdf.internal.pageSize.getHeight();
        const M = 36;
        let y = 50;

        // collect all values
        const data = {
          stu_first: document.getElementById('stu_first')?.value||'',
          stu_middle: document.getElementById('stu_middle')?.value||'',
          stu_last: document.getElementById('stu_last')?.value||'',
          aad_first: document.getElementById('aad_first')?.value||'',
          aad_middle: document.getElementById('aad_middle')?.value||'',
          aad_last: document.getElementById('aad_last')?.value||'',
          father_name: document.getElementById('father_name')?.value||'',
          mother_name: document.getElementById('mother_name')?.value||'',
          residence: document.getElementById('residence')?.value||'',
          tehsil: document.getElementById('tehsil')?.value||'',
          district: document.getElementById('district')?.value||'',
          father_contact: document.getElementById('father_contact')?.value||'',
          mother_contact: document.getElementById('mother_contact')?.value||'',
          aadhaar_no: document.getElementById('aadhaar_no')?.value||'',
          dob_fig: document.getElementById('dob_fig')?.value||'',
          dob_words: document.getElementById('dob_words')?.value||'',
          bank_acc: document.getElementById('bank_acc')?.value||'',
          bank_name: document.getElementById('bank_name')?.value||'',
          bank_branch: document.getElementById('bank_branch')?.value||'',
          ifsc: document.getElementById('ifsc')?.value||'',
          category: document.getElementById('category')?.value||'',
          blood_group: document.getElementById('blood_group')?.value||'',
          ration_no: document.getElementById('ration_no')?.value||'',
          ration_type: document.getElementById('ration_type')?.value||'',
          class_join: document.getElementById('class_join')?.value||'',
          pen_no: document.getElementById('pen_no')?.value||'',
          declaration_text: document.getElementById('declaration_text')?.value||'',
        };
// Page 1
        pdf.setFontSize(14); pdf.setFont('helvetica','bold');
        pdf.text('GOVERNMENT PRIMARY SCHOOL PETHGAM WAGOORA', W/2, y, {align:'center'});
        y+=18;
        pdf.setFontSize(10); pdf.setFont('helvetica','normal');
        pdf.text('Wagoora Babareshi Road ‚Äî Near Zonal Education Office', W/2, y, {align:'center'});
        y+=14;
        pdf.text('Email ID: pspethgam@gmail.com   UDISE Code: 01022202207', W/2, y, {align:'center'});
        y+=18;
        pdf.setLineWidth(0.8);
        pdf.rect(M, y, W - M*2, H - y - 80);
        y+=24;

        pdf.setFontSize(12); pdf.setFont('helvetica','bold');
        pdf.text('ADMISSION FORM', M + 8, y); y+=18;
        pdf.setFont('helvetica','normal');

        function addRow(label, value){
          pdf.setFont('helvetica','bold'); pdf.text(label, M + 8, y);
          pdf.setFont('helvetica','normal'); pdf.text(String(value||''), M + 220, y);
          y+=16;
        }

        addRow('Student Name (F M L):', `${data.stu_first} ${data.stu_middle} ${data.stu_last}`);
        addRow('Name as per Aadhaar:', `${data.aad_first} ${data.aad_middle} ${data.aad_last}`);
        addRow('Father Name:', data.father_name);
        addRow('Mother Name:', data.mother_name);
        addRow('Residence / Tehsil / District:', `${data.residence} / ${data.tehsil} / ${data.district}`);
        addRow('Father / Mother Contact:', `${data.father_contact} / ${data.mother_contact}`);
        addRow('Aadhaar No:', data.aadhaar_no);
        addRow('DOB (figures):', data.dob_fig ? formatDate(data.dob_fig) : '');
        addRow('DOB (words):', data.dob_words);
        addRow('Bank A/c:', data.bank_acc);
        addRow('Bank Name / Branch / IFSC:', `${data.bank_name} / ${data.bank_branch} / ${data.ifsc}`);
        addRow('Category:', data.category);
        addRow('Blood Group:', data.blood_group);
        addRow('Ration Card No / Type:', `${data.ration_no} / ${data.ration_type}`);

        // insert photo top-right if available
        if(formState.photoDataUrl){
          try{
            pdf.addImage(formState.photoDataUrl, 'JPEG', W - M - 140, 150, 120, 150);
          }catch(e){
            try{ pdf.addImage(formState.photoDataUrl, 'PNG', W - M - 140, 150, 120, 150); }catch(e2){}
          }
    }
// signature lines
        const footY = H - 120;
        pdf.setFont('helvetica','normal');
        pdf.text('Signature of Parent/Guardian', M + 8, footY);
        pdf.text('Signature of Head of Institution', W - M - 240, footY);
        pdf.line(M + 8, footY + 6, M + 200, footY + 6);
        pdf.line(W - M - 240, footY + 6, W - M - 20, footY + 6);

        // Page 2 - Consent & Declaration
        pdf.addPage();
        let yy = 60;
        pdf.setFont('helvetica','bold'); pdf.setFontSize(14);
        pdf.text('GOVERNMENT PRIMARY SCHOOL PETHGAM WAGOORA', W/2, yy, {align:'center'});
        yy += 18;
        pdf.setFont('helvetica','normal'); pdf.setFontSize(11);
        pdf.text('UDISE Code: 01022202207   Zone: Wagoora', W/2, yy, {align:'center'});
        yy += 20;
        pdf.rect(M, yy, W - M*2, H - yy - 80);
        yy += 20;

        pdf.setFont('helvetica','bold'); pdf.text('Consent by Parent / Guardian for APAAR ID Generation', M + 8, yy);
        yy += 16;
        pdf.setFont('helvetica','normal');
        const consent = 'I give my consent to share Aadhaar number and demographic information with Ministry of Education for APAAR ID creation and DigiLocker account. I authorize UIDAI to use Aadhaar for e-KYC as per law.';
        const consentLines = pdf.splitTextToSize(consent, W - M*2 - 12);
        pdf.text(consentLines, M + 8, yy);
        yy += consentLines.length * 14 + 8;

        pdf.setFont('helvetica','bold'); pdf.text('Declaration:', M + 8, yy);
        yy += 14;
        pdf.setFont('helvetica','normal');
        const declLines = pdf.splitTextToSize(data.declaration_text || '', W - M*2 - 12);
        pdf.text(declLines, M + 8, yy);
        yy += declLines.length * 14 + 10;

        pdf.text('Place of Physical Consent: ____________________', M + 8, yy); yy += 16;
        pdf.text('Date of Physical Consent: __ / __ / __', M + 8, yy); yy += 16;
        pdf.text('Signature of Parent/Guardian: ____________________', M + 8, yy); yy += 26;
        pdf.setFont('helvetica','bold');
        pdf.text('Signature of HOI: ____________________   Date: __ / __ / __', M + 8, yy);

        // Save
        const nameForFile = ((data.stu_first || 'student').replace(/\s+/g,'_'));
        pdf.save(`Admission_Form_${nameForFile}.pdf`);
      }catch(err){
        console.error(err);
        alert('Unable to generate PDF: ' + (err && err.message ? err.message : err));
      }
    }

    function formatDate(d){
      if(!d) return '';
      try{
        const dt = new Date(d);
        const dd = String(dt.getDate()).padStart(2,'0');
        const mm = String(dt.getMonth()+1).padStart(2,'0');
        const yy = dt.getFullYear();
        return dd + '/' + mm + '/' + yy;
      }catch(e){ return d; }
    }

    // close popup with Esc
    document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') closeForm(); });

    // attach file listener on DOM ready (in case openForm is not called before user selects)
    document.addEventListener('DOMContentLoaded', ()=>{
      const file = document.getElementById('photoUpload');
      if(file && !file._attached){ file.addEventListener('change', handlePreview); file._attached = true; }
    });
  </script>

</body>
</html>




          

          
 
                
